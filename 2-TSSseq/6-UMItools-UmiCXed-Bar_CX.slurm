#!/bin/bash
#SBATCH --job-name=6-UMItools-UmiCXed-Bar_CX
#SBATCH --output=6-UMItools-UmiCXed-Bar_CX.out
#SBATCH -t 3-00:00
#SBATCH --cpus-per-task=1
#SBATCH --mail-user=xxxxxx@pitt.edu
#SBATCH --mail-type=BEGIN,END,FAIL

### To correct 24bp_Barcode sequence based on UMI-tools corrected 5'end_UMI+actual_TSS sequence using UMI-tools
# remotely use Pitt HTC cluster

# Inputs: mock SAM files [*-UmiCXed-mockBarCXonUmiTss.sam] generated by <5-MkMockSam-UmiCXed-BarOnUmiTss.py>

# Outputs: standard output of UMI-tools

module purge
module load gcc/8.2.0
module load umi-tools/1.0.0
module load samtools/1.10

cd /bgfs/ckaplan/Yunye/3-TSS_sequence_library/12345-Ts_b1-extr_CX_ddp/5_6-UmiCXed-BarOnUmiTss/

# 1. Convert SAM file to BAM file using samtools
samtools view -bS AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam &
samtools view -bS ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.sam > ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam &
wait

# 2. sort BAM file
samtools sort AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools sort ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss.bam -o ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
wait

# 3. index sorted BAM file
samtools index AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
samtools index ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam &
wait

# 4. group = error correct
umi_tools group -I AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_WT_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_WT_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_WT_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_E1103G_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_E1103G_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_E1103G_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_F1086S_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_F1086S_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_F1086S_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_G1097D_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_G1097D_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_G1097D_rep4_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_G1097D_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_G1097D_rep5_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_G1097D_rep6_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=AYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=BYR_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_H1085Q_rep1_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_H1085Q_rep2_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
umi_tools group -I ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted.bam --group-out=ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-grouped.tsv --log=ARY_H1085Q_rep3_b1-UmiCXed-mockBarCXonUmiTss-sorted-group.log &
wait

date
echo "yeah! I am finished!"
